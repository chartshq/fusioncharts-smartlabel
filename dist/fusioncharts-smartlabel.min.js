!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SmartLabel=t():e.SmartLabel=t()}(window,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);var n={init:function(e){var t=e.document,i=e.navigator.userAgent,r=Math.ceil,a=Math.floor,s="fusioncharts-smartlabel-",o=s+"container",l=s+"tag";return n={win:e,containerClass:o,classNameWithTag:l,classNameWithTagBR:"fusioncharts-smartlabel-br",maxDefaultCacheLimit:1e3,classNameReg:/\bfusioncharts-smartlabel-tag\b/,classNameBrReg:/\bfusioncharts-smartlabel-br\b/,spanAdditionRegx:/(<[^<\>]+?\>)|(&(?:[a-z]+|#[0-9]+);|.)/gi,spanAdditionReplacer:'$1<span class="'+l+'">$2</span>',spanRemovalRegx:new RegExp("\\<span[^\\>]+?"+l+"[^\\>]{0,}\\>(.*?)\\<\\/span\\>","ig"),xmlTagRegEx:new RegExp("<[^>][^<]*[^>]+>","i"),brRegex:new RegExp("({br[ ]*})|(<br[ ]*>)|(<br[ ]*/>)|(<BR[ ]*/>)|(<br\\>)","g"),ltgtquotRegex:/&lt;|&gt;|&quot;|&#034;|&#039;/g,nbspRegex:/&nbsp;|&#160;|&#xA0;/g,htmlSpecialEntityRegex:/&amp;|&quot;|&lt;|&gt;/g,brReplaceRegex:/<br\/>/gi,testStrAvg:"WgI",parentContainerStyle:{position:"absolute",top:"-9999em",whiteSpace:"nowrap",padding:"0px",width:"1px",height:"1px",overflow:"hidden"},supportedStyle:{font:"font",fontFamily:"font-family","font-family":"font-family",fontWeight:"font-weight","font-weight":"font-weight",fontSize:"font-size","font-size":"font-size",lineHeight:"line-height","line-height":"line-height",fontStyle:"font-style","font-style":"font-style"},getDocumentSupport:function(){var n,r,a;return t.getElementsByClassName?(n="getElementsByClassName",r=l,a=!0):(n="getElementsByTagName",r="span",a=!1),{isIE:/msie/i.test(i)&&!e.opera,hasSVG:Boolean(e.SVGAngle||t.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),isHeadLess:new RegExp(" HtmlUnit").test(i),isWebKit:new RegExp(" AppleWebKit/").test(i),childRetriverFn:n,childRetriverString:r,noClassTesting:a}},createContainer:function(e){var i,n;if(e&&(e.offsetWidth||e.offsetHeight)){if(e.appendChild)return e.appendChild(n=t.createElement("DIV")),n.className=o,n.setAttribute("aria-hidden","true"),n.setAttribute("role","presentation"),n}else if((i=t.getElementsByTagName("body")[0])&&i.appendChild)return(n=t.createElement("DIV")).className=o,n.setAttribute("aria-hidden","true"),n.setAttribute("role","presentation"),i.appendChild(n),n},getNearestBreakIndex:function(e,t,i){if(!e||!e.length)return 0;var n,s=i._getWidthFn(),o=0,l=0,h=s(e),g=h/e.length;if(n=t,o=r(t/g),h<t)return e.length-1;for(o>e.length&&(n=t-h,o=e.length);n>0;){if(n=t-s(e.substr(0,o)),!(l=a(n/g)))return o;o+=l}for(;n<0;){if(n=t-s(e.substr(0,o)),!(l=a(n/g)))return o;o+=l}return o},parseStyle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return t.fontSize=(e.fontSize||e["font-size"]||"12px")+"",t.fontVariant=e.fontVariant||e["font-variant"]||"normal",t.fontWeight=e.fontWeight||e["font-weight"]||"normal",t.fontStyle=e.fontStyle||e["font-style"]||"normal",t.fontFamily=e.fontFamily||e["font-family"]||"Verdana,sans",t.fontSize+=-1===t.fontSize.indexOf("px")?"px":"",t},setLineHeight:function(e){var t=e.fontSize;return e.lineHeight=e.lineHeight||e["line-height"]||1.2*parseInt(t,10)+"px",e},_getCleanHeight:function(e){return e=e.replace(/px/g,""),Number(e)},_getDimentionUsingDiv:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,i=t._container;return e instanceof Array&&(e=e.join("")),i.innerHTML=e,{width:i.offsetWidth,height:i.offsetHeight}},_getDimentionUsingCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,i=t.ctx,r=t.style,a=n._getCleanHeight(r.lineHeight);return e=e instanceof Array?(e=e.join("")).replace(/<br \/>/g,""):e.replace(/<br \/>/g,""),{width:i.measureText(e).width,height:a}},_hasOnlyBRTag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!n.xmlTagRegEx.test(e)&&n.brRegex.test(e)},_getDimentionOfMultiLineText:function(){var e,t,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,s=r.replace(n.brRegex,"<br />"),o=n._getTextArray(s),l=0,h=0,g=a._getWidthFn(),c=n._getCleanHeight(a.style.lineHeight),f=c,d={};for(e=0,t=o.length;e<t;e++)"<br />"===o[e]?(h=Math.max(h,l),l=0,f+=c):(l+=i=g(o[e]),d[o[e]]=i);return{height:f,width:h=Math.max(h,l),detailObj:d}},_getTextArray:function(){var e,t,i,n,r,a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=[];for(i=(r=s.split("<br />")).length,e=0;e<i;e++){for(n=(a=r[e].split("")).length,t=0;t<n;t++)o.push(a[t]);e!==i-1&&o.push("<br />")}return o},_findLastIndex:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1?arguments[1]:void 0,n=t.length;for(e=n-1;e>=0;e--)if(t[e]===i)return e;return-1}}}},r=n,a=r.init(window),s=a.win.document,o=a.getDocumentSupport(),l=o.isWebKit?0:4.5;function h(e,t,i){var n;i=(i=i>5?i:5)<20?i:20,this.maxContainers=i,this.first=null,this.last=null,this.containers={},this.length=0,this.rootNode=e,t&&((n=s.createElementNS("http://www.w3.org/2000/svg","svg")).setAttributeNS("http://www.w3.org/2000/svg","xlink","http://www.w3.org/1999/xlink"),n.setAttributeNS("http://www.w3.org/2000/svg","height","0"),n.setAttributeNS("http://www.w3.org/2000/svg","width","0"),this.svgRoot=n,this.rootNode.appendChild(n))}h.prototype.get=function(e){var t,i,n,r=this.containers,s=this.length,o=this.maxContainers,l="";for(i in a.supportedStyle)void 0!==e[i]&&(l+=a.supportedStyle[i]+":"+e[i]+";");if(!l)return!1;if(n=r[l])this.first!==n&&(n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),n.next=this.first,n.next.prev=n,this.last===n&&(this.last=n.prev),n.prev=null,this.first=n);else{if(s>=o)for(t=s-o+1;t--;)this.removeContainer(this.last);n=this.addContainer(l)}return n},h.prototype._makeDivNode=function(e){var t,i=e.keyStr;e.node||(e.node=s.createElement("div"),e.node.className="fusioncharts-div",this.rootNode.appendChild(e.node)),t=e.node,o.isIE&&!o.hasSVG?t.style.setAttribute("cssText",i):t.setAttribute("style",i),t.setAttribute("aria-hidden","true"),t.setAttribute("role","presentation"),t.style.display="inline-block",t.innerHTML=a.testStrAvg,e.lineHeight=t.offsetHeight,e.avgCharWidth=t.offsetWidth/3,o.isBrowserLess?(e.svgText||(e.svgText=s.createElementNS("http://www.w3.org/2000/svg","text"),this.svgRoot.appendChild(t)),(t=e.svgText).setAttribute("style",i),t.textContent=a.testStrAvg,e.lineHeight=t.getBBox().height,e.avgCharWidth=(t.getBBox().width-l)/3,t.textContent="...",e.ellipsesWidth=t.getBBox().width-l,t.textContent=".",e.dotWidth=t.getBBox().width-l):(t.innerHTML="...",e.ellipsesWidth=t.offsetWidth,t.innerHTML=".",e.dotWidth=t.offsetWidth,t.innerHTML="")},h.prototype.addContainer=function(e){var t;return this.containers[e]=t={next:null,prev:null,node:null,ellipsesWidth:0,lineHeight:0,dotWidth:0,avgCharWidth:4,keyStr:e,charCache:{}},t.next=this.first,t.next&&(t.next.prev=t),this.first=t,this.last||(this.last=t),this.length+=1,t},h.prototype.removeContainer=function(e){var t=e.keyStr;t&&this.length&&e&&(this.length-=1,e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev),e.node&&e.node.parentNode.removeChild(e.node),delete this.containers[t])},h.prototype.dispose=function(){var e,t=this.containers;for(e in this.maxContainers=null,t)this.removeContainer(t[e]);this.rootNode.parentNode.removeChild(this.rootNode),this.rootNode=null,this.first=null,this.last=null};var g=h;function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){d(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var p=r.init(window),u=p.win.document,x=p.win.Math,m=x.max,b=x.round,v={" ":"&nbsp;"},y=p.getDocumentSupport(),w=y.isWebKit?0:4.5;function T(e,t,i){var n,r,a,s=!1,o=window.document.createElement("canvas");for(r in(i=i||{}).maxCacheLimit=isFinite(a=i.maxCacheLimit)?a:p.maxDefaultCacheLimit,"string"==typeof e&&(e=u.getElementById(e)),(n=p.createContainer(e)).innerHTML=p.testStrAvg,!y.isHeadLess&&(y.isIE||n.offsetHeight||n.offsetWidth)||(s=!0),n.innerHTML="",p.parentContainerStyle)n.style[r]=p.parentContainerStyle[r];this.parentContainer=n,this.ctx=o&&o.getContext&&o.getContext("2d"),this._containerManager=new g(n,s,10),this._showNoEllipses=!t,this._init=!0,this.style={},this.oldStyle={},this.options=i,this.setStyle()}function _(e){var t={};if(!e||!e.style||!e.style.cssText)return t;for(var i=e.style.cssText.split(";"),n=0;n<i.length;++n){var r=i[n].trim();if(r){var a=r.split(":");t[a[0].trim().replace(/(?:^|[-])(\w)/g,(function(e,t){return(t="-"===e.substr(0,1)?t.toUpperCase():t)||""}))]=a[1].trim()}}return t}function N(e,t,i,n,r){var a,s=[],o=[];if(e)for(;a=e.exec(i);)s.push({tagName:n,index:a.index,endTagName:r});if(t)for(;a=t.exec(i);)o.push({tagName:r,index:a.index});return{tag:s,endtag:o}}function S(e,t,i,n,r,a,s,o,l,h,g,c,f,d){var p,u,x=[e,t,i,n,r,a,s,o,l,h,g,c,f,d],m=[];for(u=0;u<x.length;u++)for(var b in x[u])if(x[u][b].length)for(p=0;p<x[u][b].length;p++)m.push(x[u][b][p]);return m=m.sort((function(e,t){return e.index-t.index}))}function C(e){return S({},{},{},{},{},{},{},{},{},{},{},{},{},N(/<br\s*\/?>/g,void 0,e,"<br />",""))}function H(e){return S(N(/<u>/g,/<\/u>/g,e,"<u>","</u>"),N(/<b>/g,/<\/b>/g,e,"<b>","</b>"),N(/<em>/g,/<\/em>/g,e,"<em>","</em>"),N(/<strike>/g,/<\/strike>/g,e,"<strike>","</strike>"),N(/<sub>/g,/<\/sub>/g,e,"<sub>","</sub>"),N(/<sup>/g,/<\/sup>/g,e,"<sup>","</sup>"),function(e,t,i,n,r){for(var a,s,o,l=[],h=[];a=e.exec(i);)s=document.createElement("p"),o=a[0]+"Dummy</abbr>",s.innerHTML=o,l.push({tagName:a[0],index:a.index,title:s.childNodes[0].title?s.childNodes[0].title:"",endTagName:r});for(;a=t.exec(i);)h.push({tagName:r,index:a.index});return{tag:l,endtag:h}}(/<abbr[\s]+([^>]+)>/g,/<\/abbr>/g,e,0,"</abbr>"),function(e,t,i,n,r){for(var a,s,o,l=[],h=[];a=e.exec(i);)s=document.createElement("p"),o=a[0]+"</a>",s.innerHTML=o,l.push({tagName:a[0],index:a.index,href:s.childNodes[0].href?s.childNodes[0].href:"",target:s.childNodes[0].target?s.childNodes[0].target:"",hreflang:s.childNodes[0].hreflang?s.childNodes[0].hreflang:"",referrerpolicy:s.childNodes[0].referrerpolicy?s.childNodes[0].referrerpolicy:"",rel:s.childNodes[0].rel?s.childNodes[0].rel:"",endTagName:r});for(;a=t.exec(i);)h.push({tagName:r,index:a.index});return{tag:l,endtag:h}}(/<a[\s]+([^>]+)>/g,/<\/a>/g,e,0,"</a>"),function(e,t,i,n,r){for(var a,s,o,l,h=[],g=[];a=e.exec(i);)s=document.createElement("p"),o=a[0]+"Dummy</span>",s.innerHTML=o,l=_(s.childNodes[0]),h.push({tagName:a[0],index:a.index,style:l||"",endTagName:r});for(;a=t.exec(i);)g.push({tagName:r,index:a.index});return{tag:h,endtag:g}}(/<span[\s]+([^>]+)>/g,/<\/span>/g,e,0,"</span>"),N(/<strong>/g,/<\/strong>/g,e,"<strong>","</strong>"),N(/<i>/g,/<\/i>/g,e,"<i>","</i>"),N(/<del>/g,/<\/del>/g,e,"<del>","</del>"),N(/<s>/g,/<\/s>/g,e,"<s>","</s>"),N(/<br\s*\/?>/g,void 0,e,"<br />",""))}function O(e,t,i,n){return t<0&&(t=e.length+t)<0&&(t=0),e.slice(0,t)+(n||"")+e.slice(t+i)}function W(e,t,i,n){var r,a,s,o=e,l=i.index,h=i.index,g=i.index+6;if(!t.length)return{text:e,charOffset:n};for(a=0,s=t.length-1,t[a].endTagName&&(g=h+t[a].endTagName.length+6);a<=s;)if(t[a].endTagName)if(a===s)o=O(o,h,0,t[a].endTagName),o=O(o,g,0,t[a].tagName),h=(l+=t[a].endTagName.length)-t[a].endTagName.length,g=l+t[a].endTagName.length+6+t[a].tagName.length,n+=t[a].endTagName.length,n+=t[a].tagName.length,a++,s--;else if(t[a].endTagName!==t[s].tagName){for(r=a;r<=s;r++)if(t[r+1]&&t[a].endTagName===t[r+1].tagName){a=r+2;break}r>s&&(o=O(o,h,0,t[a].endTagName),o=O(o,h+t[a].endTagName.length+6,0,t[a].tagName),l+=t[a].endTagName.length,h+=t[a].endTagName.length,g=l+t[a].endTagName.length+6+t[a].tagName.length,n+=t[a].endTagName.length,n+=t[a].tagName.length,a++)}else a++,s--;else a++,s--;return{text:o,charOffset:n,newBrIndex:l}}function j(e,t){var i,n,r,a=H(e),s=C(t),o=C(e),l=t,h=0;if(e===t)return e;if(o.length){for(r=0;r<o.length;r++){for(h=0,i=o[r].index;">"!==e[i];)h++,i++;e=O(e,o[r].index,h+1,""),o[r+1]&&(n=r+1,o[r+1].index-=n*(h+1))}if(s.length)for(r=0;r<s.length;r++){for(h=0,i=s[r].index;">"!==l[i];)h++,i++;l=O(l,s[r].index,h+1,"<br />"),s[r+1]&&(n=r+1,s[r+1].index-=n*(h+1),s[r+1].index+=6*n)}t=l,e,a=H(e),s=C(t)}return a.length?s.length?function(e){var t,i,n,r=C(e),a=0,s={},o=0;if(!e)return"";if(!r.length)return e;for(i=r[0].index,t=0;t<r.length;t++)s.charOffset&&s.charOffset>0?(i=r[t].index+s.charOffset,r[t].index=i):i=r[t].index,n=H(e.substring(o,i)),a=s.charOffset?s.charOffset:a,(s=W(e,n,r[t],a)).newBrIndex&&(o=s.newBrIndex+6),e=s.text;return e}(function(e,t){var i,n,r,a=e,s=t,o="",l="",h=0;if(a===s)return a;if(""===a&&""!==s)return s;if(""===s&&""!==a)return a;for(n=0,r=0;n<a.length;){if(a[n]&&!s[r]){o+=a.substring(n,a.length);break}if(s[r]&&!a[n]){o+=s.substring(r,s.length);break}if(a[n]===s[r])if("<"===a[n]){for(l=a[n],h=n+1;h<a.length;){if(">"===a[h]){l+=a[h];break}l+=a[h],h++}h>=a.length?(o+=a[n],n++,r++):(i=H(l))&&i.length?(o+=l,n+=l.length):(o+=l,n+=l.length,r+=l.length)}else o+=a[n],n++,r++;else if("<"===a[n]){for(l=a[n],h=n+1;h<a.length;){if(">"===a[h]){l+=a[h];break}l+=a[h],h++}h>=a.length?(o+=a[n],n++,r++):(i=H(l))&&i.length?(o+=l,n+=l.length):(o+=l,n+=l.length,r+=l.length)}else if("<"===s[r]){for(l=s[r],h=r+1;h<s.length;){if(">"===s[h]){l+=s[h];break}l+=s[h],h++}h>=s.length?(o+=s[r],n++,r++):(i=H(l))&&i.length?(o+=l,r+=l.length):(o+=l,n+=l.length,r+=l.length)}else" "===a[n]?n++:" "===s[r]&&r++}return o}(e,t)):function(e,t){var i,n=0,r=e,a=t.length-1,s=e.length;if(!t.length)return e;for(;n<=a;)if(t[n].endTagName)if(n===a)r=O(r,s,0,t[n].endTagName),n++,a--;else if(t[n].endTagName!==t[a].tagName){for(i=n;i<=a;i++)if(t[i+1]&&t[n].endTagName===t[i+1].tagName){n=i+2;break}i>a&&(r=O(r,s,0,t[n].endTagName),n++)}else n++,a--;else n++,a--;return r}(e,a):t}T.textToLines=function(e){return(e=e||{}).text?"string"!=typeof e.text&&(e.text=e.text.toString()):e.text="",e.lines=e.text.split(/\n|<br\s*?\/?>/gi),e},T.prototype._calCharDimWithCache=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(!this._init)return!1;var n,r,a,s,o,l,h,g,c,f=this.options.maxCacheLimit,d=this.style||{};return l=this._advancedCache=this._advancedCache||(this._advancedCache={}),h=this._advancedCacheKey||(this._advancedCacheKey=[]),g=e+d.fontSize+d.fontFamily+d.fontWeight+d.fontStyle,c=e+"init"+d.fontSize+d.fontFamily+d.fontWeight+d.fontStyle,!this.ctx&&v[e]&&(e=v[e]),t?void 0===(o=l[c])&&(r=this._getDimention(e.repeat?e.repeat(i):Array(i+1).join(e)).width,a=this._getDimention(e).width,o=l[c]=(r-i*a)/(i+1),h.push(c),h.length>f&&delete l[h.shift()]):o=0,(s=l[g])?{width:s.width,height:s.height}:((n=this._getDimention(e)).width+=o,l[g]={width:n.width,height:n.height},h.push(g),h.length>f&&delete l[h.shift()],n)},T.prototype._getDimention=function(e){return this.requireDiv||!this.ctx?p._getDimentionUsingDiv(e,this):p._getDimentionUsingCanvas(e,this)},T.prototype._getWidthFn=function(){var e=this,t=e._containerObj.svgText;return t?function(e){var i,n;return t.textContent=e,(n=(i=t.getBBox()).width-w)<1&&(n=i.width),n}:function(t){return e.requireDiv||!e.ctx?p._getDimentionUsingDiv(t,e).width:p._getDimentionUsingCanvas(t,e).width}},T.prototype._isSameStyle=function(){var e=this.oldStyle||{},t=this.style;return t.fontSize===e.fontSize&&t.fontFamily===e.fontFamily&&t.fontStyle===e.fontStyle&&t.fontWeight===e.fontWeight&&t.fontVariant===e.fontVariant},T.prototype._setStyleOfCanvas=function(){if(!this._isSameStyle()){var e,t,i=this.style,n=i.fontStyle,r=i.fontVariant,a=i.fontWeight,s=i.fontSize,o=i.fontFamily;e=n+" "+r+" "+a+" "+(s+=-1===s.indexOf("px")?"px":"")+" "+o,this.ctx.font=e,t=this._containerObj=this._containerManager.get(i),this._containerObj?(this._container=t.node,this._context=t.context,this._cache=t.charCache,this._lineHeight=t.lineHeight,this._styleNotSet=!1):this._styleNotSet=!0,t.ellipsesWidth=this._calCharDimWithCache("...",!1).width,t.dotWidth=this._calCharDimWithCache(".",!1).width,t.lineHeight=this._lineHeight=t.lineHeight||p._getCleanHeight(i.lineHeight),this.oldStyle=i}},T.prototype._setStyleOfDiv=function(){var e,t=this.style;this._containerObj=e=this._containerManager.get(t),e.node||this._containerManager._makeDivNode(this._containerObj),this._containerObj?(this._container=e.node,this._context=e.context,this._cache=e.charCache,this._lineHeight=e.lineHeight,this._styleNotSet=!1):this._styleNotSet=!0},T.prototype._updateStyle=function(){return this.requireDiv||!this.ctx?this._setStyleOfDiv():this._setStyleOfCanvas()},T.prototype.setStyle=function(e){return this.style=p.parseStyle(e),p.setLineHeight(this.style),this},T.prototype.useEllipsesOnOverflow=function(e){return this._init?(this._showNoEllipses=!e,this):this},T.prototype.getSmartText=function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!this._init)return!1;null==e?e="":"string"!=typeof e&&(e=e.toString());var a,s,o,l,h,g,c,f,d,x,b,v,w,T,_,N,S,C,H,O,W,R,L,M,D,E,B,A,k,I,z,F,q,P,V,U=!1,K=0,$=-1,G=-1,J=-1,Q=0,X=0,Y=[],Z="",ee=0,te=this._showNoEllipses?"":"...",ie=this.ctx,ne=[],re=-1,ae=-1,se=-1,oe=function(e){for(var t=/\s/,i=(e=e.replace(/^\s\s*/,"")).length;t.test(e.charAt(i-=1)););return e.slice(0,i+1)},le={text:e,maxWidth:t,maxHeight:i,width:null,height:null,oriTextWidth:null,oriTextHeight:null,oriText:e,isTruncated:!1};if(U=void 0!==r.hasHTMLTag?r.hasHTMLTag:p.xmlTagRegEx.test(e)||p.nbspRegex.test(e),P=p._hasOnlyBRTag(e),this.requireDiv=U&&!P,this._updateStyle(),A=this._lineHeight,k=this._context,I=this._container,F=(z=this._containerObj).ellipsesWidth,q=z.dotWidth,g=e.replace(p.spanAdditionRegx,"$2"),v=this._getWidthFn(),A-i<=1&&A-i>=0&&(i*=1.2),ie||I){if(!y.isBrowserLess){if(!0!==r.cleanText?(l=e=e.replace(p.ltgtquotRegex,(function(e){switch(e){case"&lt;":return"<";case"&gt;":return">";case"&quot;":case"&#034;":return'"';case"&#039;":return"'"}})),B=e,l=e=l.replace(/<u>/g,"").replace(/<\/u>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"").replace(/<strong>/g,"").replace(/<\/strong>/g,"").replace(/<em>/g,"").replace(/<\/em>/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<strike>/g,"").replace(/<\/strike>/g,"").replace(/<s>/g,"").replace(/<\/s>/g,"").replace(/<del>/g,"").replace(/<\/del>/g,"").replace(/<sub>/g,"").replace(/<\/sub>/g,"").replace(/<sup>/g,"").replace(/<\/sup>/g,"").replace(/<a[\s]+([^>]+)>/g,"").replace(/<\/a>/g,"").replace(/<abbr[\s]+([^>]+)>/g,"").replace(/<\/abbr>/g,"").replace(/<span[\s]+([^>]+)>/g,"").replace(/<\/span>/g,"")):(l=e,B=e),U?P?(e=e.replace(p.brRegex,"<br />"),V=p._getDimentionOfMultiLineText(e,this),le.oriTextWidth=c=V.width,le.oriTextHeight=f=V.height):(I.innerHTML=e,le.oriTextWidth=c=I.offsetWidth,le.oriTextHeight=f=I.offsetHeight):(l=e,!0!==r.cleanText&&(l=e=e.replace(p.ltgtquotRegex,(function(e){switch(e){case"&lt;":return"<";case"&gt;":return">";case"&quot;":case"&#034;":return'"';case"&#039;":return"'"}})),l=e=l.replace(/<u>/g,"").replace(/<\/u>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"").replace(/<strong>/g,"").replace(/<\/strong>/g,"").replace(/<em>/g,"").replace(/<\/em>/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<strike>/g,"").replace(/<\/strike>/g,"").replace(/<s>/g,"").replace(/<\/s>/g,"").replace(/<del>/g,"").replace(/<\/del>/g,"").replace(/<sub>/g,"").replace(/<\/sub>/g,"").replace(/<sup>/g,"").replace(/<\/sup>/g,"").replace(/<a[\s]+([^>]+)>/g,"").replace(/<\/a>/g,"").replace(/<abbr[\s]+([^>]+)>/g,"").replace(/<\/abbr>/g,"").replace(/<span[\s]+([^>]+)>/g,"").replace(/<\/span>/g,"")),_=this.getSize(l,!0,{hasHTMLTag:U,hasOnlyBrTag:P,cleanText:!0}),le.oriTextWidth=c=_.width,le.oriTextHeight=f=_.height),f<=i&&c<=t)return Z=j(B,e),le.text=Z,le.width=le.oriTextWidth=c,le.height=le.oriTextHeight=f,le;if(A>i)return le.text="",le.width=le.oriTextWidth=0,le.height=le.oriTextHeight=0,le}if(e=oe(e).replace(/(\s+)/g," "),h=this._showNoEllipses?t:t-F,!U||P){if(a=(Y=p._getTextArray(e)).length,s="",o=[],b=Y[0],this._cache[b]?H=this._cache[b].width:(H=v(b),this._cache[b]={width:H}),h>H&&!P)o=e.substr(0,p.getNearestBreakIndex(e,h,this)).split("");else{if(H>t)return le.text="",le.width=le.oriTextWidth=le.height=le.oriTextHeight=0,le;te&&((h=t-2*q)>H?te="..":(h=t-q)>H?te=".":(h=0,te=""))}if(ee=o.length,Q=v(o.join("")),X=this._lineHeight,n){for(;ee<a;ee+=1)if(b=o[ee]=Y[ee],"<br />"!==o[ee]){if(this._cache[b]?H=this._cache[b].width:(_&&(H=_.detailObj[b])||(H=v(b)),this._cache[b]={width:H}),(Q+=H)>h&&(s||(s=o.slice(0,-1).join("")),Q>t))return le.text=oe(s)+te,le.tooltext=le.oriText,le.width=m(K,Q),le.height=X,le.isTruncated=!0,le}else X+=this._lineHeight,J=ee,K=m(K,Q),Q=0,s=null;return le.text=o.join(""),le.width=m(K,Q),le.height=X,le}for(;ee<a;ee+=1){if(" "!==(b=o[ee]=Y[ee])||k||(b=this.ctx?" ":"&nbsp;"),"<br />"===o[ee]){if(K=m(K,Q),(X+=this._lineHeight)<=i){J=ee,Q=0,s=null;continue}if(X>i)return s=o.slice(0,-1).join(""),le.text=oe(s)+te,le.tooltext=g,le.width=K,le.height=X-this._lineHeight,le.isTruncated=!0,le}if(this._cache[b]?H=this._cache[b].width:(_&&(H=_.detailObj[b])||(H=v(b)),this._cache[b]={width:H}),(Q+=H)>h&&(s||(s=o.slice(0,-1).join("")),Q>t)){if("<br />"===Y[ee+1])continue;if(G=p._findLastIndex(Y.slice(0,o.length)," "),$=p._findLastIndex(Y.slice(0,o.length),"-"),G>J?(Q=v(o.slice(J+1,G).join("")),o.splice(G,1,"<br />"),J=G,d=G+1):$>J?($===o.length-1?(Q=v(o.slice(J+1,G).join("")),o.splice($,1,"<br />-")):(Q=v(o.slice(J+1,G).join("")),o.splice($,1,"-<br />")),J=$,d=$+1):(o.splice(o.length-1,1,"<br />"+Y[ee]),se=o.length-2,Q=v(o.slice(J+1,se+1).join("")),J=se,d=ee),(X+=this._lineHeight)>i)return le.text=oe(s)+te,le.tooltext=le.oriText,le.width=t,le.height=X-this._lineHeight,le.isTruncated=!0,le;K=m(K,Q),s=null,P?Q=p._getDimentionOfMultiLineText(o.slice(J+1).join(""),this).width:(x=p.getNearestBreakIndex(e.substr(d),h,this),Q=v(e.substr(d,x||1)),o.length<d+x&&(ee=(o=o.concat(e.substr(o.length,d+x-o.length).split(""))).length-1))}}return K=m(K,Q),Z=j(B,o.join("")),le.text=Z,le.width=K,le.height=X,le}for(g=e.replace(p.spanAdditionRegx,"$2"),e=(e=e.replace(p.spanAdditionRegx,p.spanAdditionReplacer)).replace(/(<br\s*\/*\>)/g,'<span class="'+[p.classNameWithTag," ",p.classNameWithTagBR].join("")+'">$1</span>'),I.innerHTML=e,S=0,C=(N=I[y.childRetriverFn](y.childRetriverString)).length;S<C;S+=1)O=N[S],(y.noClassTesting||p.classNameReg.test(O.className))&&""!==(W=O.innerHTML)&&(" "===W?ae=ne.length:"-"===W&&(re=ne.length),ne.push({spaceIdx:ae,dashIdx:re,elem:O}),Y.push(W));if(ee=0,(H=(a=ne.length)&&ne[0].elem.offsetWidth)>t||!a)return le.text="",le.width=le.oriTextWidth=le.height=le.oriTextHeight=0,le;if(H>h&&!this._showNoEllipses&&((h=t-2*q)>H?te="..":(h=t-q)>H?te=".":(h=0,te="")),w=ne[0].elem.offsetLeft,T=ne[0].elem.offsetTop,n)for(;ee<a;ee+=1)(R=(O=ne[ee].elem).offsetLeft-w+O.offsetWidth)>h&&(E||(E=ee),I.offsetWidth>t&&(D=ee,ee=a));else for(;ee<a;ee+=1)L=(O=ne[ee].elem).offsetHeight+(O.offsetTop-T),M=null,(R=O.offsetLeft-w+O.offsetWidth)>h?(E||(E=ee),R>t&&(G=ne[ee].spaceIdx,$=ne[ee].dashIdx,G>J?(ne[G].elem.innerHTML="<br/>",J=G):$>J?(ne[$].elem.innerHTML=$===ee?"<br/>-":"-<br/>",J=$):O.parentNode.insertBefore(M=u.createElement("br"),O),O.offsetHeight+O.offsetTop>i?(M?M.parentNode.removeChild(M):J===$?ne[$].elem.innerHTML="-":ne[G].elem.innerHTML=" ",D=ee,ee=a):E=null)):L>i&&(D=ee,ee=a);if(D<a){for(le.isTruncated=!0,E=E||D,ee=a-1;ee>=E;ee-=1)(O=ne[ee].elem).parentNode.removeChild(O);for(;ee>=0;ee-=1)O=ne[ee].elem,p.classNameBrReg.test(O.className)?O.parentNode.removeChild(O):ee=0}return le.text=I.innerHTML.replace(p.spanRemovalRegx,"$1").replace(/\&amp\;/g,"&"),le.isTruncated&&(le.text+=te,le.tooltext=g),le.height=I.offsetHeight,le.width=I.offsetWidth,le}return le.error=new Error("Body Tag Missing!"),le},T.prototype.getSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this._init)return!1;null==e?e="":"string"!=typeof e&&(e=e.toString());var n,r,a,s,o,l,h=0,g=0,c={},d=i.hasHTMLTag,u=i.hasOnlyBrTag;if(void 0===d&&(d=p.xmlTagRegEx.test(e)||p.nbspRegex.test(e)),void 0===u&&(u=p._hasOnlyBRTag(e)),this.requireDiv=d&&!u,i.cleanText||(e=(e=e.replace(p.ltgtquotRegex,(function(e){switch(e){case"&lt;":return"<";case"&gt;":return">";case"&quot;":case"&#034;":return'"';case"&#039;":return"'"}}))).replace(/<u>/g,"").replace(/<\/u>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"").replace(/<strong>/g,"").replace(/<\/strong>/g,"").replace(/<em>/g,"").replace(/<\/em>/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<strike>/g,"").replace(/<\/strike>/g,"").replace(/<s>/g,"").replace(/<\/s>/g,"").replace(/<del>/g,"").replace(/<\/del>/g,"").replace(/<sub>/g,"").replace(/<\/sub>/g,"").replace(/<sup>/g,"").replace(/<\/sup>/g,"").replace(/<a[\s]+([^>]+)>/g,"").replace(/<\/a>/g,"").replace(/<abbr[\s]+([^>]+)>/g,"").replace(/<\/abbr>/g,"").replace(/<span[\s]+([^>]+)>/g,"").replace(/<\/span>/g,"")),this._updateStyle(),l=this._container,!t)return this._calCharDimWithCache(e);for(s=0,o=(n=e.split("")).length;s<o;s++)r=n[s],a=this._calCharDimWithCache(r,!1,n.length),g=m(g,a.height),h+=a.width,c[r]=a.width;return u?f(f({},p._getDimentionOfMultiLineText(e,this)),{},{detailObj:c}):d?(l.innerHTML=e,{width:l.offsetWidth,height:l.offsetHeight,detailObj:c}):{width:b(h),height:g,detailObj:c}},T.prototype.getOriSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSize(e,t,i)},T.prototype.dispose=function(){return this._init?(this._containerManager&&this._containerManager.dispose&&this._containerManager.dispose(),delete this._container,delete this._context,delete this._cache,delete this._containerManager,delete this._containerObj,delete this.id,delete this.style,delete this.parentContainer,delete this._showNoEllipses,this):this};t.default=T}]).default}));